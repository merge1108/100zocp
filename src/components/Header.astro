---
import site from "../content/site.json";
const DEFAULT_NAV = [
  { label: "홈", href: "/" },
  { label: "솔루션", href: "/solutions" },
  { label: "패키지", href: "/packages" },
  { label: "포트폴리오", href: "/portfolio" },
  { label: "상담문의", href: "/contact", cta: true },
];
const BRAND = (site as any)?.brand || "백조마케팅";
const NAV = Array.isArray((site as any)?.nav) && (site as any).nav.length ? (site as any).nav : DEFAULT_NAV;
const path = (Astro.url?.pathname || "/").replace(/\/$/, "") || "/";
const isActive = (href:string) => path === href || path.startsWith(href + "/");
---
<header class="hdr" role="banner">
  <div class="container bar">
    <a class="brand" href="/"><strong>{BRAND}</strong></a>

    <nav aria-label="주요 메뉴">
      {NAV.map((it:any) => (
        it.cta ? (
          <a class="btn" href={it.href} aria-current={isActive(it.href)?"page":undefined}>{it.label}</a>
        ) : (
          <a href={it.href} aria-current={isActive(it.href)?"page":undefined}>{it.label}</a>
        )
      ))}
    </nav>

    <button class="menu-btn" aria-controls="drawer" aria-expanded="false">메뉴</button>
  </div>

  <div id="drawer" class="drawer" role="dialog" aria-modal="true" aria-label="모바일 메뉴">
    {NAV.map((it:any) => (
      it.cta ? (
        <a class="btn" style="margin:10px 16px 16px" href={it.href}>{it.label}</a>
      ) : (
        <a href={it.href}>{it.label}</a>
      )
    ))}
  </div>

  <script is:inline>
    const btn = document.querySelector('.menu-btn');
    const dr  = document.getElementById('drawer');
    btn?.addEventListener('click', ()=> {
      const on = dr?.classList.toggle('on');
      btn?.setAttribute('aria-expanded', on ? 'true' : 'false');
    });
    document.querySelectorAll('a[href^="/\"]').forEach(a=>{
      a.addEventListener('click', ()=> dr?.classList.remove('on'));
    });
  </script>
</header>
